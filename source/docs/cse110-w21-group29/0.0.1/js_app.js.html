<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js/app.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Appends%25252520a%25252520text%25252520element%25252520containing%25252520the%25252520current%25252520year%25252520from%25252520a%25252520Date()%25252520object..html">Appends a text element containing the current year from a Date() object.</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Constructor%2520for%2520the%2520Add%2520Task%2520Row%2520UI.html">Constructor for the Add Task Row UI</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Constructor%2520for%2520the%2520Task%2520List%2520UI.html">Constructor for the Task List UI</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Constructor%2520for%2520the%2520TaskList%2520object..html">Constructor for the TaskList object.</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Constructor%2520for%2520the%2520timer%2520object.html">Constructor for the timer object</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Constructs%2520the%2520HTML%2520for%2520the%2520non-editable%2520TaskList.html">Constructs the HTML for the non-editable TaskList</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Constructs%2520the%2520HTML%2520of%2520the%2520EditableTaskListBody%2520and%2520EditableTaskListInput..html">Constructs the HTML of the EditableTaskListBody and EditableTaskListInput.</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Creates%2520the%2520Custom%2520HTMLElement%2520for%2520the%2520Timer%2520class.html">Creates the Custom HTMLElement for the Timer class</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Timer.html">Timer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Timer.html#startTimer">startTimer</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="UsernameInput.html">UsernameInput</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#cancel">cancel</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#edit">edit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#remove">remove</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#rowTemplate">rowTemplate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#save">save</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">js/app.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file The main controller of the HTML and interaction between Front-End and Back-End.
 * @author Andy Young
 * @author Donald Wolfson
 * @author Justin Lee
 * @author Enrique Gan
 */

/**
 * STATE:
 * {
 *  Username: {String}
 *    null: redirect to index.html
 *  Started: {Boolean}
 *    true: display TimerUI &amp; ViewOnlyTaskList,
 *    false: go to Editable Task List display.
 *  TotalPomos: {Number}
 *    Elapsed pomos.
 *  Timer: {Boolean}
 *    true: pomodoro
 *    false: break
 *      TotalPomos % 4 == 0: long break
 *      else: short break
 * }
 */

import EditableTaskList from './EditableTaskList.js';
import ViewOnlyTaskList from './ViewOnlyTaskList.js';
import TimerUI from './TimerUI.js';
import TaskList from './TaskList.js';
import BreakPrompt from './BreakPrompt.js';

// Edge Case: Redirect to index.html if not logged in.
// TODO: Run this on load
if (!localStorage.getItem('Username')) {
  window.location.href = 'index.html';
}

const appContainer = document.querySelector('.app-container');

// initialize the timer based on current state
function initTimer(timer) {
  const timerState = localStorage.getItem('Timer');

  timer.reset();

  // if timer is true set pomo, otherwise it is a break
  if (timerState === 'true') {
    timer.setColorGreen();
    timer.createTimer(0, 25);
  } else {
    const totalPomos = Number(localStorage.getItem('TotalPomos'));
    const breakPrompt = new BreakPrompt();

    timer.setColorRed();
    timer.appendChild(breakPrompt);

    // if there has been 4 pomos then it is a long break
    if (totalPomos > 0 &amp;&amp; totalPomos % 4 === 0) {
      // long break
      timer.createTimer(0, 10);
    } else {
      // short break
      timer.createTimer(0, 5);
    }
  }
}

function handleClick(timer, taskList) {
  let active = false;

  timer.firstElementChild.addEventListener('click', () => {
    if (!active) {
      active = true;
      timer.startTimer().then(() => {
        const timerState = localStorage.getItem('Timer');

        if (timerState === 'true') {
          localStorage.setItem('TotalPomos', Number(localStorage.getItem('TotalPomos')) + 1);
          taskList.addPomo();
        }

        if (timerState === 'false') {
          if (timer.lastElementChild.getChecked()) {
            taskList.finishTask();
            taskList.render();
          }

          timer.lastElementChild.remove();
        }

        localStorage.setItem('Timer', timerState === 'false');

        initTimer(timer);

        active = false;
      });
    }
  });
}

function showTimer() {
  const timerUI = new TimerUI();
  const votl = new ViewOnlyTaskList();

  handleClick(timerUI, votl);
  initTimer(timerUI);

  appContainer.appendChild(timerUI);
  appContainer.appendChild(votl);

  document.querySelector('.app-title').innerHTML = `Current Task: ${votl.data.todo[0].name}`;
}

if (localStorage.getItem('Started')) {
  showTimer();
} else {
  appContainer.appendChild(new EditableTaskList());
  document.querySelector('.app-title').innerHTML = `${localStorage.getItem('Username')}'s Day`;

  appContainer.querySelector('button').addEventListener('click', () => {
    const data = new TaskList();
    if (data.todo.length > 0) {
      localStorage.setItem('Started', true);
      localStorage.setItem('Timer', true);
      localStorage.setItem('TotalPomos', 0);
      appContainer.lastElementChild.remove();
      showTimer();
    }
  });
}

// TODO: If New User, display Editable Task List.
// TODO: Once User has tasks list (start day button?) display timer and ViewOnlyTaskList.

/*
document.addEventListener('keydown', (e) => {
  if (e.code === 'ArrowRight') {
    appContainer.replaceChild(new ViewOnlyTaskList(), appContainer.lastElementChild);
  } else if (e.code === 'ArrowLeft') {
    appContainer.replaceChild(new EditableTaskList(), appContainer.lastElementChild);
  }
});

// Global Variables:
const body = document.querySelector('.container');
const timerUI = new TimerUI();

body.appendChild(timerUI);
timerUI.createTimer(0, 10);
timerUI.setColorGreen();

async function testTimer() {
  await timerUI.startTimer();
  console.log('BOOM :)');
  timerUI.setColorRed();
}

testTimer();
*/
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a> on Sat Mar 06 2021 02:15:17 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
