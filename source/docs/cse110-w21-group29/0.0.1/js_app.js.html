<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js/app.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Appends%2520a%2520text%2520element%2520containing%2520the%2520current%2520year%2520from%2520a%2520Date()%2520object..html">Appends a text element containing the current year from a Date() object.</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="BreakPrompt.html">BreakPrompt</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="BreakPrompt.html#getChecked">getChecked</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Constructor%2520for%2520the%2520Add%2520Task%2520Row%2520UI.html">Constructor for the Add Task Row UI</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Constructor%2520for%2520the%2520Task%2520List%2520UI.html">Constructor for the Task List UI</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Constructor%2520for%2520the%2520TaskList%2520object..html">Constructor for the TaskList object.</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Constructor%2520for%2520the%2520timer%2520object.html">Constructor for the timer object</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Constructs%2520the%2520HTML%2520for%2520the%2520non-editable%2520TaskList.html">Constructs the HTML for the non-editable TaskList</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Constructs%2520the%2520HTML%2520of%2520the%2520EditableTaskListBody%2520and%2520EditableTaskListInput..html">Constructs the HTML of the EditableTaskListBody and EditableTaskListInput.</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Creates%2520the%2520Custom%2520HTMLElement%2520for%2520the%2520Timer%2520class.html">Creates the Custom HTMLElement for the Timer class</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="StartContainer.html">StartContainer</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Timer.html">Timer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Timer.html#startTimer">startTimer</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="TODO.html">TODO</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="UsernameInput.html">UsernameInput</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="WelcomeMessage.html">WelcomeMessage</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#cancel">cancel</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#edit">edit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#handleClick">handleClick</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#handleOnLoadWillholdallEdgeCasesthatshouldbecheckwhenapageisloaded.">handleOnLoad
Will hold all Edge Cases that should be check when a page is loaded.</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#initTimer">initTimer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#remove">remove</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#rowTemplate">rowTemplate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#save">save</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#showTimerDisplaystheTimerandbeginstohandletheeventsofinteraction.">showTimer
Displays the Timer and begins to handle the events of interaction.</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">js/app.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file The main controller of the HTML and interaction between Front-End and Back-End.
 * @author Andy Young
 * @author Donald Wolfson
 * @author Justin Lee
 * @author Enrique Gan
 */

/* ******************************** Imports ********************************* */
import EditableTaskList from './EditableTaskList.js';
import ViewOnlyTaskList from './ViewOnlyTaskList.js';
import TimerUI from './TimerUI.js';
import TaskList from './TaskList.js';
import BreakPrompt from './BreakPrompt.js';

/**
 * STATE:
 * {
 *  Username: {String}
 *    null: redirect to index.html
 *  Started: {Boolean}
 *    true: display TimerUI &amp; ViewOnlyTaskList,
 *    false: go to Editable Task List display.
 *  TotalPomos: {Number}
 *    Elapsed pomos.
 *  Timer: {Boolean}
 *    true: pomodoro
 *    false: break
 *      TotalPomos % 4 == 0: long break
 *      else: short break
 * }
 */

/* ******************************* DOM Values ******************************* */

const appContainer = document.querySelector('.app-container');

/* **************************** Helper Functions **************************** */

// TODO: Once User has tasks list (start day button?) display timer and ViewOnlyTaskList.

/**
 * @function handleOnLoad
 * Will hold all Edge Cases that should be check when a page is loaded.
 */
function handleOnLoad() {
  // Redirect to index.html if no name is in localStorage.
  if (!localStorage.getItem('Username')) {
    window.location.href = 'index.html';
  }
}

/**
 * @function initTimer
 * @param {Object} timer The Timer object.
 * Initialize the timer based on current STATE.
 */
function initTimer(timer) {
  const timerState = localStorage.getItem('Timer');
  timer.reset();

  // If timer is true set pomo, otherwise it is a break
  if (timerState === 'true') {
    timer.setColorGreen();
    timer.createTimer(0, 25);
  } else {
    const totalPomos = Number(localStorage.getItem('TotalPomos'));
    const breakPrompt = new BreakPrompt();

    timer.setColorRed();
    timer.appendChild(breakPrompt);

    // If there has been 4 pomos then it is a long break
    if (totalPomos > 0 &amp;&amp; totalPomos % 4 === 0) {
      // Long break
      timer.createTimer(0, 10);
    } else {
      // Short break
      timer.createTimer(0, 5);
    }
  }
}

/**
 * @function
 * @param {Object} timer The Timer object.
 * @param {Object} taskList The TaskList object.
 * Handle starting the timer and updating the Pomos.
 */
function handleClick(timer, taskList) {
  let active = false;

  timer.firstElementChild.addEventListener('click', () => {
    if (!active) {
      active = true;
      timer.startTimer().then(() => {
        const timerState = localStorage.getItem('Timer');

        if (timerState === 'true') {
          localStorage.setItem('TotalPomos', Number(localStorage.getItem('TotalPomos')) + 1);
          taskList.addPomo();
        }

        if (timerState === 'false') {
          if (timer.lastElementChild.getChecked()) {
            taskList.finishTask();
            taskList.render();
          }

          timer.lastElementChild.remove();
        }

        localStorage.setItem('Timer', timerState === 'false');

        initTimer(timer);

        active = false;
      });
    }
  });
}

/**
 * @function showTimer
 * Displays the Timer and begins to handle the events of interaction.
 */
function showTimer() {
  const timerUI = new TimerUI();
  const votl = new ViewOnlyTaskList();

  handleClick(timerUI, votl);
  initTimer(timerUI);

  appContainer.appendChild(timerUI);
  appContainer.appendChild(votl);

  document.querySelector('.app-title').innerHTML = `Current Task: ${votl.data.todo[0].name}`;
}

/* ***************************** Event Handlign ***************************** */

if (localStorage.getItem('Started')) {
  showTimer();
} else {
  appContainer.appendChild(new EditableTaskList());
  document.querySelector('.app-title').innerHTML = `${localStorage.getItem('Username')}'s Day`;

  appContainer.querySelector('button').addEventListener('click', () => {
    const data = new TaskList();
    if (data.todo.length > 0) {
      localStorage.setItem('Started', true);
      localStorage.setItem('Timer', true);
      localStorage.setItem('TotalPomos', 0);
      appContainer.lastElementChild.remove();
      showTimer();
    }
  });
}

// Handle any edge cases on loading into the page.
window.addEventListener('load', handleOnLoad);
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a> on Sun Mar 07 2021 19:11:36 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
